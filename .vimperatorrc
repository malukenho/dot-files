" mashiro .vimperatorrc
" firefox 3.6 + vimperator hg4187

" Initialize {{{1
mapclear
cmapclear
imapclear


" Options {{{1
set runtimepath=~/.vimperator
set titlestring=Firefox
set messages=100
set verbose=1
set defsearch=google
set guioptions=rb
set wildoptions=auto
set complete=sl
set history=1000
set newtab=all
set showtabline=2
set laststatus=2
set popups=tab
set hlsearch
set ignorecase
set incsearch
set smartcase

set visualbell
highlight Bell display: none; 

colorscheme indigo
let mapleader = ","

" about:config {{{2
set! general.autoScroll=false
set! ui.key.generalAccessKey=0
set! browser.tabs.closeButtons=2
set! browser.urlbar.filter.javascript=false
set! browser.urlbar.maxRichResults=20
set! browser.sessionstore.max_tabs_undo=20
set! dom.popup_maximum=500
set! mousewheel.withnokey.numlines=6
set! mousewheel.withnokey.sysnumlines=false


" QMarks {{{1
silent qmark c http://www.google.com/calendar/render?hl=ja
silent qmark f http://fastladder.com/reader/
silent qmark F http://favotter.matope.com/user.php?user=YurineMashiro
silent qmark g https://github.com/
silent qmark G http://gist.github.com/
silent qmark h http://translate.google.co.jp/translate_t?hl=ja&sl=en&tl=ja#
silent qmark m https://mail.google.com/mail/
silent qmark M http://mixi.jp/home.pl
silent qmark t http://twitter.com/home/
silent qmark T http://www.tumblr.com/dashboard/
silent qmark p http://www.pixiv.net/mypage.php
silent qmark w http://www.wolframalpha.com/
silent qmark W https://wave.google.com/wave/
silent qmark y http://search.yahoo.com/


" Bmarks {{{1
silent bmark -title="Google US Search" -tags=keyword -keyword=g http://www.google.com/search?q=%s
silent bmark -title="Twitter" -tags=keyword -keyword=tw http://twitter.com/%s
silent bmark -title="Twitter Search" -tags=keyword -keyword=ts http://search.twitter.com/search?q=%s
silent bmark -title="ふぁぼったー" -tags=keyword -keyword=fav http://favotter.matope.com/user.php?user=%s
silent bmark -title="Ustream" -tags=keyword -keyword=ust http://www.ustream.tv/channel/%s
silent bmark -title="はてなダイアリー" -tags=keyword -keyword=hd http://d.hatena.ne.jp/%s
silent bmark -title="はてなブックマーク" -tags=keyword -keyword=hb http://b.hatena.ne.jp/%s
silent bmark -title="ニコニコ動画" -tags=keyword -keyword=nico http://www.nicovideo.jp/watch/%s
silent bmark -title="Yahoo! Search" -tags=keyword -keyword=y http://search.yahoo.com/search;_ylt=?p=%s


" Commands {{{1
" http://vimperator.g.hatena.ne.jp/snaka72/20090203/1233674801
command! feedkeys -nargs=* js events.feedkeys("<args>")
command! copybufferurl -nargs=0 js util.copyToClipboard(buffer.URL)
command! addhatenaantena -nargs=0 -description="Add to Hatena Antena" js liberator.open("http://a.hatena.ne.jp/append?"+buffer.URL, liberator.NEW_TAB)


" Plugins {{{1
" ime_controller.js {{{2
let g :ex_ime_mode = "inactive"
let g :textarea_ime_mode = "inactive"


" migemo_hint.js {{{2
"set hintmatching=custom


" appendAnchor.js {{{2
let g:auto_append_anchor = "true"


" copy.js {{{2
noremap <Leader>c :copy 
javascript <<EOM
liberator.globalVariables.copy_templates = [
	{ label: 'titleAndURL',    value: '%TITLE% %URL%' },
	{ label: 'title',          value: '%TITLE%' },
	{ label: 'url',            value: '%URL%' },
	{ label: 'markdown',       value: '[%TITLE%](%URL% "%TITLE%")' },
	{ label: 'markdownsel',    value: '[%SEL%](%URL% "%TITLE%")' },
	{ label: 'htmlblockquote', value: '<blockquote cite="%URL%" title="%TITLE%">%HTMLSEL%</blockquote>' },
	{ label: 'ASIN',           value: 'copy ASIN code from Amazon', custom: function(){return content.document.getElementById('ASIN').value;} },
	{ label: 'Amazon',         value: 'copy ASIN code and URL from Amazon', custom: function(){return 'http://amazon.co.jp/o/ASIN/' + content.document.getElementById('ASIN').value;} }
];
EOM


" multi_requester.js {{{2
noremap <Leader>mt :mr<Space>twitter-search-pcod-no-jp<Space>
noremap <Leader>mT :mr<Space>twitter-search-pcod-no-jp<Space>YurineMashiro<CR>
noremap <Leader>mf :mr<Space>favotter-new<Space>
noremap <Leader>mF :mr<Space>favotter-new<Space>YurineMashiro<CR>


" ldrize_cooperation.js {{{2
noremap <Leader>q :toggleldrc<CR>
let g:ldrc_enable = "true"
let g:ldrc_captureMappings = "['j','k','p','o','?']" 
let g:ldrc_intelligence_bind = "true"
let g:ldrc_hints = "true"
let g:ldrc_skip = "0.1"


" feedSomeKey_2.js {{{2
autocmd LocationChange .* :fmapc

" LDR / fastladder / OpenFL
autocmd LocationChange http://(reader\\.livedoor\\.com|fastladder\\.com|0\\.0\\.0\\.0\\:3000)/reader/ :fmap j k s a p o v r w W J K <Space> <S-Space> c z > <
autocmd LocationChange http://(reader\\.livedoor\\.com|fastladder\\.com|0\\.0\\.0\\.0\\:3000)/reader/ :fmap p,pj
autocmd LocationChange http://(reader\\.livedoor\\.com|fastladder\\.com|0\\.0\\.0\\.0\\:3000)/reader/ :fmap J,<Space>
autocmd LocationChange http://(reader\\.livedoor\\.com|fastladder\\.com|0\\.0\\.0\\.0\\:3000)/reader/ :fmap K,<S-Space>
autocmd LocationChange http://(reader\\.livedoor\\.com|fastladder\\.com|0\\.0\\.0\\.0\\:3000)/reader/ :fmap i,tj
autocmd LocationChange http://(reader\\.livedoor\\.com|fastladder\\.com|0\\.0\\.0\\.0\\:3000)/reader/ :fmap e,tj

" Gmail
"autocmd LocationChange mail\\.google\\.com/mail :fmap gi gs gt gd ga gc *a *n *r *u *s *t u k j o p n c / q ? x s y e m ! # r a f N ] [ z . I U S E GL
autocmd LocationChange mail\\.google\\.com/mail :fmap gi gs gt gd ga gc *a *n *r *u *s *t u k j o p n c / q ? x s e m ! # r a N ] [ z . I U S E GL
autocmd LocationChange mail\\.google\\.com/mail :fmap E,Ie

" Tumblr
autocmd LocationChange http://.*\\.tumblr\\.com/ :fmap j k
autocmd LocationChange http://.*\\.tumblr\\.com/ :fmap i,tj
autocmd LocationChange http://.*\\.tumblr\\.com/ :fmap e,tj


" direct_bookmark.js {{{2
let g:direct_sbm_use_services_by_tag = "h"
let g:direct_sbm_use_services_by_post = "h"   
noremap <Leader>ba :sbm 
noremap <Leader>bA :sbm<CR>
noremap <Leader>be :bentry<CR>
noremap <Leader>bt :btags<CR>
noremap <Leader>bi :bicon<CR>


" sbmcommentsviewer.js {{{2
let g:def_sbm_format = "timestamp,id,tagsAndComment"
let g:def_sbms = "h"
noremap <Leader>bc :viewSBMComments<CR>


" uaSwitchLite.js {{{2
javascript <<EOM
liberator.globalVariables.useragent_list = [{
		description: 'Internet Explorer 7 (Windows Vista)',
		useragent: 'Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0)',
		appname: 'Microsoft Internet Explorer',
		appversion: '4.0 (compatible; MSIE 7.0; Windows NT 6.0)',
		platform: 'Win32',
		vendor: '',
		vendorSub: ''
	}, {
		description: 'Netscape 4.8 (Windows Vista)',
		useragent: 'Mozilla/4.8 [en] (Windows NT 6.0; U)',
		appname: 'Netscape',
		appversion: '4.8 [en] (Windows NT 6.0; U)',
		platform: 'Win32',
		vendor: '',
		vendorSub: ''
	}, {
		description: 'Opera 9.25 (Windows Vista)',
		useragent: 'Opera/9.25 (Windows NT 6.0; U; en)',
		appname: 'Opera',
		appversion: '9.25 (Windows NT 6.0; U; en)',
		platform: 'Win32',
	}, {
		description: 'iPhone',
		useragent: 'Mozilla/5.0 (iPhone; U; CPU iPhone OS 2_0 like Mac OS X; ja-jp) AppleWebKit/525.18.1 (KHTML, like Gecko) Version/3.1.1 Mobile/5A345 Safari/525.20',
		appname: 'Safari',
		platform: 'OS X iPhone'
	},{
		description: 'DoCoMo',
		useragent: 'DoCoMo/2.0 P900i(c100;TB;W20H09)',
		appname: 'P900i',
		platform: 'iMode'
}];
EOM


" refcontrol.js {{{2
let g:refcontrol_enabled = "true"
javascript <<EOM
liberator.globalVariables.refcontrol = {
	'@DEFAULT'          : '@NORMAL',
	'fc2.com'           : '@FORGE',
	'blogs.yahoo.co.jp' : '@FORGE',
	'blog.goo.ne.jp'    : '@FORGE',
	'ameblo.jp'         : '@FORGE',
	'nekobooru.net'     : '@FORGE',
};
EOM


" localkeymode.js {{{2
let g:localkeymode_enable = "false"
js <<EOM
liberator.globalVariables.localKeyMappings = [
	[/www\.nicovideo\.jp\/watch/, [
		['p s sh sl sH sL S v m r c f F'],
		['p',   ':stplay'],
		['sh',  ':stseek! -10'],
		['sl',  ':stseek! +10'],
		['sH',  ':stseek! -60'],
		['sL',  ':stseek! +60'],
		['S',   ':stseek '], 
		['v',   ':stvolume '],
		['m',   ':stmute'],
		['r',   ':strepeat'],
		['c',   ':stcomment'],
		['f',   ':stlarge'],
		['F',   ':stfullscreen']
	]],
];
EOM


" browser_object.js {{{2
let g:browser_object_prefix = ',' 


" no_reading.js {{{2
let g:no_reading_do_echo = 1


" Javascripts {{{1
" ======================================================================
" ステータスバーにfeedボタンを表示 {{{2
" http://d.hatena.ne.jp/teramako/20071205/p1
javascript <<EOM
(function(){
	var feedPanel = document.createElement('statusbarpanel');
	var feedButton = document.getElementById('feed-button');
	feedPanel.setAttribute('id','feed-panel-clone');
	feedPanel.appendChild(feedButton.cloneNode(true));
	feedButton.parentNode.removeChild(feedButton);
	document.getElementById('status-bar').insertBefore(feedPanel,document.getElementById('security-button'));
	})();
EOM


" はてなブックマーク拡張 {{{2
javascript <<EOF
if (typeof hBookmark != 'undefined') liberator.loadScript('chrome://hatenabookmark/content/vimperator/plugin/hatenabookmark.js', {__proto__: this});

// キーボードショートカットの指定
// 空(null)を指定すれば hints や nnoremap を上書きしなくなる
liberator.globalVariables.hBookmark_shortcuts = {
	hintsAdd     : 'c',
	hintsComment : 'C',
	add          : ['c'],
	comment      : ['C'],
};

// コマンドの設定
// ここから下の設定は、はてなブックマーク拡張のバージョン 1.2.4a1 以降で有効です。
liberator.globalVariables.hBookmark_commands = {
	hbsearch             : 'hb[search]',
	hbsearch_tab         : 'hbt[absearch]',
	hbsearch_comment     : 'hbc[omment]',
	hbsearch_comment_tab : 'hbtc[omment]',
	hbsearch_url         : 'hbu[rl]',
	hbsearch_url_tab     : 'hbtu[rl]',
	hbsearch_title       : 'hbti[tle]',
	hbsearch_title_tab   : 'hbtti[tle]',
};

// :hb! url 等の bang(!) 付きで開いた場合の挙動。
// 標準ははてブエントリーページを開く entryPage が設定されている。
// 他に新規タブで開く openNewTab がある。
// また、文字列ではなく自分で定義した関数をセットすることもできる。
liberator.globalVariables.hBookmark_bangFunction = 'entryPage';

// 検索時の wait(ms)
liberator.globalVariables.hBookmark_search_interval = 1000;

// 一度に検索する limit
liberator.globalVariables.hBookmark_search_limit = 20;

// 検索時の表示の最大件数。この件数に達するまで検索し続ける。
liberator.globalVariables.hBookmark_search_max_limit = 100;
EOF


" ユーザースタイルシートを読み込む {{{2
javascript <<EOM
(function(){
	let filter = new RegExp('^.*\.css$');
	let dir = io.File('~/.vimperator/styles')
	if (dir.exists() && dir.isDirectory() && dir.isReadable()) {
		let files = dir.readDirectory(true);
		files.forEach(function (file) {
			if (filter.test(file.path)) {
				io.source(file.path, false);
			}
		});
	}
})();
EOM


" Toggle Autopagerize {{{2
javascript <<EOM
	let (evaluateXPath = util.evaluateXPath || buffer.evaluateXPath) {
		commands.addUserCommand(
			['autopagerize'],
			'Toggle AutoPagerize',
			function (args) {
				buffer.followLink(
					evaluateXPath('id("autopagerize_help")/div/a[@class="autopagerize_link"]').snapshotItem(0)
				);
			},
			{},
			true
		);
	}
EOM


" Mappings {{{1
" ======================================================================

" escape
noremap <C-@> <Esc>
cnoremap <C-@> <Esc>
inoremap <C-@> <Esc>

" depth
noremap <BS> gu
noremap <C-BS> gU

" scrolling
noremap j 6j
noremap k 6k
noremap J <C-d>
noremap K <C-u>
noremap <A-j> 6j
noremap <A-k> 6k
noremap <A-h> 6h
noremap <A-l> 6l

" tabs
noremap l gt
noremap h gT
noremap <C-l> :tabmove! +1<CR>
noremap <C-h> :tabmove! -1<CR>

" others
"noremap <C-a> a
"noremap <C-A> A
noremap y Y
noremap Y y
noremap zi zI
noremap zI zi
noremap zm zM
noremap zM zm
noremap zo zO
noremap zO zo
noremap zr zR
noremap zR zr
noremap zz zZ
noremap zZ zz

noremap <C-r> :restart<CR>
noremap <Leader>h :history! -max=1 
noremap <Leader>s :source ~/.vimperatorrc<CR>
noremap U :undo 

noremap eu :set encoding=UTF-8<CR>
noremap es :set encoding=Shift_JIS<CR>
noremap ee :set encoding=EUC-JP<CR>
noremap ej :set encoding=ISO-2022-JP<CR>

" ex
cnoremap <C-j> <Nop>
cnoremap <C-b> <Left>
cnoremap <C-f> <Right>
cnoremap <C-n> <Tab>
cnoremap <C-p> <S-Tab>

" input
inoremap <C-f> <Right>
inoremap <C-b> <Left>
inoremap <C-p> <Up>
inoremap <C-n> <Down>

" copy/paste
javascript <<EOM
if (liberator.has("Win32")) {
	liberator.execute("cnoremap <C-a> <C-v><C-a>");
	liberator.execute("cnoremap <C-z> <C-v><C-z>");
	liberator.execute("cnoremap <C-x> <C-v><C-x>");
	liberator.execute("cnoremap <C-c> <C-v><C-c>");
	liberator.execute("cnoremap <C-v> <C-v><C-v>");
	liberator.execute("inoremap <C-a> <C-v><C-a>");
	liberator.execute("inoremap <C-z> <C-v><C-z>");
	liberator.execute("inoremap <C-x> <C-v><C-x>");
	liberator.execute("inoremap <C-c> <C-v><C-c>");
	liberator.execute("inoremap <C-v> <C-v><C-v>");
}
else if (liberator.has("MacUnix")) {
	liberator.execute("cnoremap <M-a> <C-v><M-a>");
	liberator.execute("cnoremap <M-z> <C-v><M-z>");
	liberator.execute("cnoremap <M-x> <C-v><M-x>");
	liberator.execute("cnoremap <M-c> <C-v><M-c>");
	liberator.execute("cnoremap <M-v> <C-v><M-v>");
	liberator.execute("inoremap <M-a> <C-v><M-a>");
	liberator.execute("inoremap <M-z> <C-v><M-z>");
	liberator.execute("inoremap <M-x> <C-v><M-x>");
	liberator.execute("inoremap <M-c> <C-v><M-c>");
	liberator.execute("inoremap <M-v> <C-v><M-v>");
}
else {
}
EOM

" toggle autopagerize
noremap <silent> <Leader>a :autopagerize<CR>


" End {{{1
source! ~/.vimperatorrc.local

" vim: ts=2 sw=2 sts=2 ft=vimperator
